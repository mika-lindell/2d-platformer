var gfx;gfx={tileW:24,tileH:24,init:function(){var t;return t=document.querySelector("#game"),this.ctx=null!=t?"function"==typeof t.getContext?t.getContext("2d"):void 0:void 0,this.ctx?(this.w=t.width,this.h=t.height,!0):!1},clear:function(){return this.ctx.clearRect(0,0,gfx.w,gfx.h)},load:function(t){return this.sprites=new Image,this.sprites.src="resources/sprites.png",this.sprites.onload=function(){return t()}},drawSprite:function(t,e,n,r,i,s,u){return null==i&&(i=1),null==s&&(s=1),null==u&&(u=1),i*=this.tileW,s*=this.tileH,this.ctx.drawImage(this.sprites,t*i,e*s,i,s,n,r,i*u,s*u)}};var keys;keys={up:!1,down:!1,left:!1,right:!1,space:!1,reset:function(){return this.up=this.down=this.left=this.right=this.space=!1},trigger:function(t,e,n){switch(t){case 37:this.left=e;break;case 39:this.right=e;break;case 38:this.up=e;break;case 40:this.down=e;break;case 32:e&&console.log("FIRE!"),this.space=e}return n.preventDefault()}},document.addEventListener("keydown",function(t){return keys.trigger(t.keyCode,!0,t)},!1),document.addEventListener("keyup",function(t){return keys.trigger(t.keyCode,!1,t)},!1);var player;player={x:3*gfx.tileW,y:5*gfx.tileH,speed:4,update:function(){return keys.left&&(this.x-=this.speed),keys.right&&(this.x+=this.speed),keys.down&&(this.y+=this.speed),keys.up?this.y-=this.speed:void 0},render:function(t){return t.drawSprite(0,0,this.x,this.y)}};var game;game={init:function(){return gfx.init()?(gfx.load(function(){var t,e,n,r,i,s,u,o,a,h;for(o=function(t){return Math.floor(Math.random()*t)},r=function(){return{x:o(gfx.w),y:o(gfx.h)}},t=function(t){return gfx.drawSprite(0,1,t.x,t.y)},u=function(){var t,e;for(e=[],t=0;20>t;t++)e.push(r());return e}(),a=0,h=u.length;h>a;a++)s=u[a],t(s);return n=".............\n...........*.\n....@#@@@@#@.\n.....#....#..\n.....#....#..\n..*..#...@@@.\n..@@@@@...#..\n...#......#..\n...#......#..\n...#......#..\n.OOOOOOOOOOOO",i=function(t){var e,n,r,i,s,u,o;for(i={"@":[4,1],O:[4,0],"*":[5,1],"#":[5,0]},e=function(){var e,n,i,s;for(i=t.split("\n"),s=[],e=0,n=i.length;n>e;e++)r=i[e],s.push(r.split(""));return s}(),o=[],s=0,u=e.length;u>s;s++)r=e[s],o.push(function(){var t,e,s;for(s=[],t=0,e=r.length;e>t;t++)n=r[t],s.push(i[n]);return s}());return o},e=i(n),setInterval(function(){var t,n,r,i,s,u,o,a,h,f;for(player.update(),gfx.clear(),s=o=0,h=e.length;h>o;s=++o)for(t=e[s],r=a=0,f=t.length;f>a;r=++a)n=t[r],n&&(i=r*gfx.tileW,u=s*gfx.tileH,gfx.drawSprite(n[0],n[1],i,u));return player.render(gfx)},33)}),console.log("Ready.")):(alert("Could not set up game canvas"),void 0)}},game.init();